# ğŸš€ Cloudflare Pages éƒ¨ç½²æ­¥é©Ÿ

## âœ… å‰ç½®æº–å‚™ï¼ˆå·²å®Œæˆï¼‰

- âœ… ä»£ç¢¼å·²æ¨é€åˆ° GitHub
- âœ… Worker API å·²éƒ¨ç½²ï¼š`https://apcs-auth-api.589411.workers.dev`
- âœ… D1 æ•¸æ“šåº«å·²åˆå§‹åŒ–
- âœ… å‰ç«¯ API ç«¯é»å·²é…ç½®

---

## ğŸ“‹ éƒ¨ç½²åˆ° Cloudflare Pages

### æ­¥é©Ÿ 1ï¼šç™»å…¥ Cloudflare Dashboard

1. æ‰“é–‹ç€è¦½å™¨ï¼Œè¨ªå•ï¼šhttps://dash.cloudflare.com
2. ä½¿ç”¨ä½ çš„ Cloudflare å¸³è™Ÿç™»å…¥

---

### æ­¥é©Ÿ 2ï¼šå‰µå»º Pages é …ç›®

1. åœ¨å·¦å´é¸å–®é»æ“Š **Workers & Pages**
2. é»æ“Š **Create application**
3. é¸æ“‡ **Pages** æ¨™ç±¤
4. é»æ“Š **Connect to Git**

---

### æ­¥é©Ÿ 3ï¼šé€£æ¥ GitHub

1. é¸æ“‡ **GitHub**
2. å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ï¼Œéœ€è¦æˆæ¬Š Cloudflare è¨ªå•ä½ çš„ GitHub
3. é»æ“Š **Authorize Cloudflare**
4. é¸æ“‡ä½ çš„ GitHub å¸³è™Ÿ

---

### æ­¥é©Ÿ 4ï¼šé¸æ“‡ Repository

1. åœ¨ Repository åˆ—è¡¨ä¸­æ‰¾åˆ° **FAE**
2. é»æ“Š **FAE** repository

---

### æ­¥é©Ÿ 5ï¼šé…ç½®æ§‹å»ºè¨­ç½®

**é‡è¦ï¼šè«‹æŒ‰ç…§ä»¥ä¸‹è¨­ç½®å¡«å¯«**

| è¨­ç½®é … | å€¼ |
|--------|-----|
| **Project name** | `apcs-space-course`ï¼ˆæˆ–ä½ å–œæ­¡çš„åç¨±ï¼‰ |
| **Production branch** | `feature/apcs-space-exploration` |
| **Framework preset** | `None` |
| **Build command** | ç•™ç©º |
| **Build output directory** | `/` |
| **Root directory (advanced)** | `APCS/web` âš ï¸ **é‡è¦ï¼** |

**æˆªåœ–åƒè€ƒï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Project name                            â”‚
â”‚ apcs-space-course                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Production branch                       â”‚
â”‚ feature/apcs-space-exploration          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Framework preset                        â”‚
â”‚ None                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Build command                           â”‚
â”‚ (ç•™ç©º)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Build output directory                  â”‚
â”‚ /                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Root directory (advanced) âš ï¸             â”‚
â”‚ APCS/web                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### æ­¥é©Ÿ 6ï¼šéƒ¨ç½²

1. æª¢æŸ¥æ‰€æœ‰è¨­ç½®æ˜¯å¦æ­£ç¢º
2. é»æ“Š **Save and Deploy**
3. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆç´„ 1-2 åˆ†é˜ï¼‰

**éƒ¨ç½²éç¨‹ä¸­ä½ æœƒçœ‹åˆ°ï¼š**
```
ğŸ”¨ Initializing build environment...
ğŸ“¦ Cloning repository...
ğŸ”§ Installing dependencies...
ğŸš€ Building your site...
âœ… Deployment successful!
```

---

### æ­¥é©Ÿ 7ï¼šç²å–ç¶²ç«™ URL

éƒ¨ç½²æˆåŠŸå¾Œï¼Œä½ æœƒçœ‹åˆ°ï¼š

```
ğŸ‰ Success! Your site is live at:
https://apcs-space-course.pages.dev
```

**è¤‡è£½é€™å€‹ URLï¼**

---

## ğŸ”§ éƒ¨ç½²å¾Œé…ç½®

### æ›´æ–° CORS è¨­ç½®

ç¾åœ¨ä½ æœ‰äº† Pages URLï¼Œéœ€è¦æ›´æ–° Worker çš„ CORS è¨­ç½®ï¼š

1. ç·¨è¼¯æœ¬åœ°çš„ `workers/wrangler.toml`ï¼š

```toml
[vars]
ALLOWED_ORIGINS = "https://apcs-space-course.pages.dev,http://localhost:8000"
```

2. é‡æ–°éƒ¨ç½² Workerï¼š

```bash
cd /Users/yen-tangchang/Documents/github/FAE/APCS/workers
wrangler deploy
```

---

## âœ… æ¸¬è©¦éƒ¨ç½²

### 1. è¨ªå•ç¶²ç«™

```
https://apcs-space-course.pages.dev
```

**æª¢æŸ¥ï¼š**
- [ ] ç¶²ç«™æ­£å¸¸è¼‰å…¥
- [ ] æ˜Ÿç©ºèƒŒæ™¯é¡¯ç¤º
- [ ] èª²ç¨‹å¡ç‰‡é¡¯ç¤º
- [ ] A1-A3 å¯ä»¥é»æ“Š
- [ ] B1-E1 é¡¯ç¤ºé–å®šåœ–æ¨™

---

### 2. æ¸¬è©¦å…è²»èª²ç¨‹

è¨ªå•ï¼š
```
https://apcs-space-course.pages.dev/lessons/L1/A1.html
```

**é æœŸçµæœï¼š**
- âœ… å¯ä»¥æ­£å¸¸è¨ªå•
- âœ… å…§å®¹å®Œæ•´é¡¯ç¤º

---

### 3. æ¸¬è©¦ä»˜è²»èª²ç¨‹ï¼ˆæ‡‰è©²è¢«é˜»æ“‹ï¼‰

è¨ªå•ï¼š
```
https://apcs-space-course.pages.dev/lessons/L2/B1.html
```

**é æœŸçµæœï¼š**
- âœ… é¡¯ç¤ºä»˜è²»ç‰†
- âœ… æœ‰ã€ŒæŸ¥çœ‹æ–¹æ¡ˆã€ã€ã€Œè¼¸å…¥å…Œæ›ç¢¼ã€æŒ‰éˆ•
- âŒ çœ‹ä¸åˆ°èª²ç¨‹å…§å®¹

---

### 4. æ¸¬è©¦å…Œæ›ç¢¼è§£é–

1. è¨ªå•ï¼š
```
https://apcs-space-course.pages.dev/unlock.html
```

2. è¼¸å…¥æ¸¬è©¦å…Œæ›ç¢¼ï¼š`APCS2024-DEMO01`

3. é»æ“Šã€Œé©—è­‰å…Œæ›ç¢¼ã€

**é æœŸçµæœï¼š**
- âœ… é¡¯ç¤ºã€Œé©—è­‰ä¸­...ã€
- âœ… é¡¯ç¤ºã€Œè§£é–æˆåŠŸï¼ã€
- âœ… è‡ªå‹•è·³è½‰åˆ°é¦–é 

4. å†æ¬¡è¨ªå• B1ï¼š
```
https://apcs-space-course.pages.dev/lessons/L2/B1.html
```

**é æœŸçµæœï¼š**
- âœ… å¯ä»¥æ­£å¸¸è¨ªå•
- âœ… å…§å®¹å®Œæ•´é¡¯ç¤º

---

## ğŸ¯ è‡ªå®šç¾©åŸŸåï¼ˆå¯é¸ï¼‰

å¦‚æœä½ æƒ³ä½¿ç”¨è‡ªå·±çš„åŸŸåï¼ˆä¾‹å¦‚ï¼š`apcs.fae.academy`ï¼‰ï¼š

### æ­¥é©Ÿ 1ï¼šæ·»åŠ è‡ªå®šç¾©åŸŸå

1. åœ¨ Cloudflare Pages é …ç›®é é¢
2. é»æ“Š **Custom domains**
3. é»æ“Š **Set up a custom domain**
4. è¼¸å…¥ä½ çš„åŸŸå
5. é»æ“Š **Continue**

### æ­¥é©Ÿ 2ï¼šé…ç½® DNS

Cloudflare æœƒè‡ªå‹•é…ç½® DNS è¨˜éŒ„ã€‚

### æ­¥é©Ÿ 3ï¼šæ›´æ–° CORS

è¨˜å¾—åœ¨ `wrangler.toml` ä¸­æ·»åŠ ä½ çš„è‡ªå®šç¾©åŸŸåï¼š

```toml
[vars]
ALLOWED_ORIGINS = "https://apcs.fae.academy,https://apcs-space-course.pages.dev,http://localhost:8000"
```

---

## ğŸ” æ•…éšœæ’é™¤

### å•é¡Œ 1ï¼šç¶²ç«™é¡¯ç¤º 404

**åŸå› ï¼š** Root directory è¨­ç½®éŒ¯èª¤

**è§£æ±ºï¼š**
1. å›åˆ° Pages é …ç›®è¨­ç½®
2. Settings â†’ Builds & deployments
3. ç¢ºèª Root directory æ˜¯ `APCS/web`
4. é‡æ–°éƒ¨ç½²

---

### å•é¡Œ 2ï¼šAPI èª¿ç”¨å¤±æ•—ï¼ˆCORS éŒ¯èª¤ï¼‰

**åŸå› ï¼š** Worker CORS è¨­ç½®æœªåŒ…å« Pages URL

**è§£æ±ºï¼š**
```bash
# ç·¨è¼¯ workers/wrangler.toml
# æ·»åŠ  Pages URL åˆ° ALLOWED_ORIGINS

# é‡æ–°éƒ¨ç½² Worker
cd workers
wrangler deploy
```

---

### å•é¡Œ 3ï¼šå…Œæ›ç¢¼é©—è­‰å¤±æ•—

**åŸå› ï¼š** Worker URL éŒ¯èª¤æˆ– Worker æœªéƒ¨ç½²

**è§£æ±ºï¼š**
1. æª¢æŸ¥ `web/scripts/api-client.js` ä¸­çš„ Worker URL
2. ç¢ºèª Worker å·²éƒ¨ç½²ï¼š
```bash
curl https://apcs-auth-api.589411.workers.dev/api/health
```

---

### å•é¡Œ 4ï¼šåœ–ç‰‡æˆ– CSS è¼‰å…¥å¤±æ•—

**åŸå› ï¼š** è·¯å¾‘éŒ¯èª¤

**è§£æ±ºï¼š**
1. æŒ‰ F12 æ‰“é–‹é–‹ç™¼è€…å·¥å…·
2. æŸ¥çœ‹ Network æ¨™ç±¤
3. æ‰¾åˆ°å¤±æ•—çš„è³‡æº
4. æª¢æŸ¥è·¯å¾‘æ˜¯å¦æ­£ç¢º

---

## ğŸ“Š ç›£æ§å’Œåˆ†æ

### Cloudflare Analytics

1. åœ¨ Pages é …ç›®é é¢
2. é»æ“Š **Analytics**
3. æŸ¥çœ‹ï¼š
   - è¨ªå•é‡
   - åœ°ç†åˆ†å¸ƒ
   - ç†±é–€é é¢

### Worker Analytics

1. Workers & Pages â†’ apcs-auth-api
2. é»æ“Š **Metrics**
3. æŸ¥çœ‹ï¼š
   - è«‹æ±‚æ•¸
   - éŒ¯èª¤ç‡
   - éŸ¿æ‡‰æ™‚é–“

---

## ğŸ‰ éƒ¨ç½²å®Œæˆæª¢æŸ¥æ¸…å–®

- [ ] ä»£ç¢¼å·²æ¨é€åˆ° GitHub
- [ ] Pages é …ç›®å·²å‰µå»º
- [ ] Root directory è¨­ç½®ç‚º `APCS/web`
- [ ] éƒ¨ç½²æˆåŠŸ
- [ ] ç¶²ç«™å¯ä»¥è¨ªå•
- [ ] å…è²»èª²ç¨‹å¯ä»¥è¨ªå•
- [ ] ä»˜è²»èª²ç¨‹é¡¯ç¤ºä»˜è²»ç‰†
- [ ] å…Œæ›ç¢¼è§£é–åŠŸèƒ½æ­£å¸¸
- [ ] Worker CORS å·²æ›´æ–°
- [ ] æ‰€æœ‰æ¸¬è©¦é€šé

---

## ğŸš€ æ­å–œï¼ä½ çš„èª²ç¨‹ç¶²ç«™å·²ä¸Šç·šï¼

**ç¶²ç«™ URLï¼š** `https://apcs-space-course.pages.dev`

**ä¸‹ä¸€æ­¥ï¼š**
1. åˆ†äº«çµ¦æœ‹å‹æ¸¬è©¦
2. æ”¶é›†åé¥‹
3. æº–å‚™è¡ŒéŠ·ç´ æ
4. é–‹å§‹æ¨å»£ï¼

**éœ€è¦å¹«åŠ©ï¼Ÿ**
- Cloudflare æ–‡æª”ï¼šhttps://developers.cloudflare.com/pages/
- Worker æ–‡æª”ï¼šhttps://developers.cloudflare.com/workers/

---

## ğŸ“ é‡è¦æé†’

### æ¸¬è©¦å…Œæ›ç¢¼

ç›®å‰æ•¸æ“šåº«ä¸­æœ‰ 5 å€‹æ¸¬è©¦å…Œæ›ç¢¼ï¼š
- `APCS2024-DEMO01`
- `APCS2024-DEMO02`
- `APCS2024-DEMO03`
- `APCS2024-TEST01`
- `APCS2024-TEST02`

**âš ï¸ æ­£å¼ä¸Šç·šå‰è¨˜å¾—ï¼š**
1. åˆªé™¤æˆ–ç¦ç”¨æ¸¬è©¦å…Œæ›ç¢¼
2. å‰µå»ºæ­£å¼çš„å…Œæ›ç¢¼
3. è¨­ç½®å…Œæ›ç¢¼ç®¡ç†æµç¨‹

### æ·»åŠ æ–°å…Œæ›ç¢¼

```bash
wrangler d1 execute apcs-course-db \
  --command="INSERT INTO redemption_codes (code, plan) VALUES ('APCS2024-PROD001', 'full')"
```

---

**ç¥ä½ çš„èª²ç¨‹å¤§è³£ï¼** ğŸ‰ğŸš€
