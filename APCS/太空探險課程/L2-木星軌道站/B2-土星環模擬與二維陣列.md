# B2: åœŸæ˜Ÿç’°æ¨¡æ“¬ï¼šäºŒç¶­é™£åˆ—èˆ‡çŸ©é™£æ“ä½œ

## ğŸš€ ä»»å‹™èƒŒæ™¯

ä½ çš„æ¢éšªéšŠæ­£åœ¨æ¥è¿‘åœŸæ˜Ÿï¼ç‚ºäº†å®‰å…¨ç©¿è¶ŠåœŸæ˜Ÿç’°ï¼Œéœ€è¦å»ºç«‹ä¸€å€‹ä¸‰ç¶­ç©ºé–“æ¨¡æ“¬ç³»çµ±ã€‚åœŸæ˜Ÿç’°å¯ä»¥ç”¨äºŒç¶­ç¶²æ ¼è¡¨ç¤ºï¼Œæ¯å€‹æ ¼å­è¨˜éŒ„è©²å€åŸŸçš„å†°æ™¶å¯†åº¦ã€‚ä½ éœ€è¦å­¸æœƒè™•ç†é€™ç¨®ã€Œè¡¨æ ¼å¼ã€çš„æ•¸æ“šçµæ§‹ã€‚

åœ¨é€™å€‹è¨“ç·´æ¨¡çµ„ä¸­ï¼Œä½ å°‡å­¸ç¿’ï¼š
- äºŒç¶­é™£åˆ—ï¼ˆçŸ©é™£ï¼‰çš„å‰µå»ºèˆ‡æ“ä½œ
- å‰ç¶´å’ŒæŠ€å·§ï¼šå¿«é€Ÿè¨ˆç®—å€åŸŸç¸½å’Œ
- å·®åˆ†é™£åˆ—ï¼šé«˜æ•ˆè™•ç†å€é–“æ›´æ–°
- çŸ©é™£éæ­·çš„å„ç¨®æ¨¡å¼

## ğŸ“š çŸ¥è­˜é»èªªæ˜

### ä»€éº¼æ˜¯äºŒç¶­é™£åˆ—ï¼Ÿ

äºŒç¶­é™£åˆ—å°±åƒä¸€å€‹è¡¨æ ¼æˆ–æ£‹ç›¤ï¼Œæœ‰è¡Œï¼ˆrowï¼‰å’Œåˆ—ï¼ˆcolumnï¼‰ï¼š

```
    åˆ—0  åˆ—1  åˆ—2  åˆ—3
è¡Œ0  5    8    2    9
è¡Œ1  3    7    1    4
è¡Œ2  6    2    8    5
```

### å‰µå»ºäºŒç¶­é™£åˆ—

```python
# âœ… æ­£ç¢ºæ–¹æ³•ï¼šæ¯è¡Œéƒ½æ˜¯ç¨ç«‹çš„åˆ—è¡¨
matrix = [[0 for _ in range(cols)] for _ in range(rows)]

# âŒ éŒ¯èª¤æ–¹æ³•ï¼šæ‰€æœ‰è¡Œéƒ½æŒ‡å‘åŒä¸€å€‹åˆ—è¡¨ï¼
matrix_wrong = [[0] * cols] * rows  # å±éšªï¼
```

**ç‚ºä»€éº¼éŒ¯èª¤æ–¹æ³•å±éšªï¼Ÿ**
```python
matrix = [[0] * 3] * 2
matrix[0][0] = 5
print(matrix)  # [[5, 0, 0], [5, 0, 0]] - å…©è¡Œéƒ½è¢«ä¿®æ”¹äº†ï¼
```

### å‰ç¶´å’Œï¼ˆPrefix Sumï¼‰

å‰ç¶´å’Œæ˜¯ä¸€ç¨®ã€Œç©ºé–“æ›æ™‚é–“ã€çš„æŠ€å·§ï¼Œå¯ä»¥åœ¨ O(1) æ™‚é–“å…§è¨ˆç®—ä»»æ„å€é–“çš„ç¸½å’Œã€‚

**ä¸€ç¶­å‰ç¶´å’Œï¼š**
```python
arr = [1, 2, 3, 4, 5]
# å‰ç¶´å’Œï¼š[0, 1, 3, 6, 10, 15]
# prefix[i] = arr[0] + arr[1] + ... + arr[i-1]

# è¨ˆç®— arr[1:4] çš„ç¸½å’Œ
sum_1_to_3 = prefix[4] - prefix[1]  # 9
```

### å·®åˆ†é™£åˆ—ï¼ˆDifference Arrayï¼‰

å·®åˆ†é™£åˆ—ç”¨æ–¼é«˜æ•ˆè™•ç†ã€Œå€é–“å¢æ¸›ã€æ“ä½œï¼š

```python
# å°å€é–“ [L, R] çš„æ‰€æœ‰å…ƒç´  +x
diff[L] += x
diff[R+1] -= x

# æœ€å¾Œé‚„åŸé™£åˆ—
for i in range(1, n):
    arr[i] = arr[i-1] + diff[i]
```

## ğŸ’» ç¯„ä¾‹ç¨‹å¼ç¢¼

### ç¯„ä¾‹ 1ï¼šåœŸæ˜Ÿç’°å¯†åº¦åœ°åœ–

```python
import sys

# ä»»å‹™ï¼šå‰µå»ºä¸¦é¡¯ç¤ºåœŸæ˜Ÿç’°å¯†åº¦åœ°åœ–
rows = int(sys.stdin.readline())
cols = int(sys.stdin.readline())

# å‰µå»ºäºŒç¶­é™£åˆ—
density_map = []
for i in range(rows):
    row = list(map(int, sys.stdin.readline().strip().split()))
    density_map.append(row)

# é¡¯ç¤ºåœ°åœ–
print("åœŸæ˜Ÿç’°å¯†åº¦åœ°åœ–ï¼š")
for i in range(rows):
    for j in range(cols):
        print(f"{density_map[i][j]:3}", end=" ")
    print()  # æ›è¡Œ

# æ‰¾å‡ºæœ€å±éšªå€åŸŸï¼ˆå¯†åº¦æœ€é«˜ï¼‰
max_density = 0
danger_pos = (0, 0)

for i in range(rows):
    for j in range(cols):
        if density_map[i][j] > max_density:
            max_density = density_map[i][j]
            danger_pos = (i, j)

print(f"\næœ€å±éšªå€åŸŸï¼šè¡Œ{danger_pos[0]} åˆ—{danger_pos[1]}")
print(f"å¯†åº¦ï¼š{max_density}")
```

### ç¯„ä¾‹ 2ï¼šçŸ©é™£è½‰ç½®ï¼ˆæ—‹è½‰è¦–è§’ï¼‰

```python
import sys

# ä»»å‹™ï¼šå°‡çŸ©é™£è½‰ç½®ï¼ˆè¡Œåˆ—äº’æ›ï¼‰
n = int(sys.stdin.readline())
matrix = []
for i in range(n):
    row = list(map(int, sys.stdin.readline().strip().split()))
    matrix.append(row)

# å‰µå»ºè½‰ç½®çŸ©é™£
transposed = [[0 for _ in range(n)] for _ in range(n)]

for i in range(n):
    for j in range(n):
        transposed[j][i] = matrix[i][j]

print("åŸå§‹çŸ©é™£ï¼š")
for row in matrix:
    print(row)

print("\nè½‰ç½®å¾Œï¼š")
for row in transposed:
    print(row)
```

### ç¯„ä¾‹ 3ï¼šå‰ç¶´å’Œ - å¿«é€Ÿå€åŸŸæŸ¥è©¢

```python
import sys

# ä»»å‹™ï¼šä½¿ç”¨å‰ç¶´å’Œå¿«é€Ÿè¨ˆç®—å­çŸ©é™£çš„ç¸½å’Œ
n = int(sys.stdin.readline())
matrix = []
for i in range(n):
    row = list(map(int, sys.stdin.readline().strip().split()))
    matrix.append(row)

# å»ºç«‹äºŒç¶­å‰ç¶´å’Œ
# prefix[i][j] = å¾ (0,0) åˆ° (i-1,j-1) çš„çŸ©å½¢å€åŸŸç¸½å’Œ
prefix = [[0 for _ in range(n+1)] for _ in range(n+1)]

for i in range(1, n+1):
    for j in range(1, n+1):
        prefix[i][j] = (matrix[i-1][j-1] + 
                       prefix[i-1][j] + 
                       prefix[i][j-1] - 
                       prefix[i-1][j-1])

# æŸ¥è©¢ï¼šè¨ˆç®—å¾ (r1,c1) åˆ° (r2,c2) çš„å­çŸ©é™£ç¸½å’Œ
q = int(sys.stdin.readline())  # æŸ¥è©¢æ¬¡æ•¸
for _ in range(q):
    r1, c1, r2, c2 = map(int, sys.stdin.readline().strip().split())
    
    # è½‰æ›ç‚º 1-indexed
    r1 += 1
    c1 += 1
    r2 += 1
    c2 += 1
    
    # ä½¿ç”¨å®¹æ–¥åŸç†è¨ˆç®—
    result = (prefix[r2][c2] - 
             prefix[r1-1][c2] - 
             prefix[r2][c1-1] + 
             prefix[r1-1][c1-1])
    
    print(f"å€åŸŸ ({r1-1},{c1-1}) åˆ° ({r2-1},{c2-1}) ç¸½å’Œï¼š{result}")
```

### ç¯„ä¾‹ 4ï¼šå·®åˆ†é™£åˆ— - éš•çŸ³é›¨æ¨¡æ“¬

```python
import sys

# ä»»å‹™ï¼šæ¨¡æ“¬å¤šæ¬¡éš•çŸ³é›¨å°åœŸæ˜Ÿç’°çš„å½±éŸ¿
n = int(sys.stdin.readline())  # å€åŸŸæ•¸é‡
density = [0] * n  # åˆå§‹å¯†åº¦éƒ½æ˜¯ 0

# å·®åˆ†é™£åˆ—
diff = [0] * (n + 1)

# è®€å–éš•çŸ³é›¨äº‹ä»¶
m = int(sys.stdin.readline())  # äº‹ä»¶æ•¸é‡
for _ in range(m):
    L, R, impact = map(int, sys.stdin.readline().strip().split())
    # å°å€é–“ [L, R] å¢åŠ  impact
    diff[L] += impact
    diff[R+1] -= impact

# é‚„åŸå¯¦éš›å¯†åº¦
for i in range(n):
    if i == 0:
        density[i] = diff[i]
    else:
        density[i] = density[i-1] + diff[i]

print("æœ€çµ‚å¯†åº¦åˆ†å¸ƒï¼š")
print(density)

# æ‰¾å‡ºæœ€å±éšªå€åŸŸ
max_density = max(density)
danger_zones = [i for i, d in enumerate(density) if d == max_density]
print(f"æœ€é«˜å¯†åº¦ï¼š{max_density}")
print(f"å±éšªå€åŸŸï¼š{danger_zones}")
```

### ç¯„ä¾‹ 5ï¼šèºæ—‹çŸ©é™£éæ­·

```python
import sys

# ä»»å‹™ï¼šä»¥èºæ—‹æ–¹å¼éæ­·çŸ©é™£ï¼ˆé †æ™‚é‡ï¼‰
n = int(sys.stdin.readline())
matrix = []
for i in range(n):
    row = list(map(int, sys.stdin.readline().strip().split()))
    matrix.append(row)

result = []
top, bottom = 0, n - 1
left, right = 0, n - 1

while top <= bottom and left <= right:
    # å‘å³
    for col in range(left, right + 1):
        result.append(matrix[top][col])
    top += 1
    
    # å‘ä¸‹
    for row in range(top, bottom + 1):
        result.append(matrix[row][right])
    right -= 1
    
    # å‘å·¦
    if top <= bottom:
        for col in range(right, left - 1, -1):
            result.append(matrix[bottom][col])
        bottom -= 1
    
    # å‘ä¸Š
    if left <= right:
        for row in range(bottom, top - 1, -1):
            result.append(matrix[row][left])
        left += 1

print("èºæ—‹éæ­·çµæœï¼š")
print(result)
```

## ğŸ” ç¨‹å¼ç¢¼è§£èªª

### é—œéµæŠ€è¡“é»

1. **äºŒç¶­é™£åˆ—çš„æ­£ç¢ºå‰µå»º**
   ```python
   # æ¯æ¬¡è¿´åœˆéƒ½å‰µå»ºæ–°çš„åˆ—è¡¨
   matrix = [[0 for _ in range(cols)] for _ in range(rows)]
   
   # ç­‰åƒ¹æ–¼ï¼š
   matrix = []
   for i in range(rows):
       row = []
       for j in range(cols):
           row.append(0)
       matrix.append(row)
   ```

2. **å‰ç¶´å’Œçš„å®¹æ–¥åŸç†**
   ```
   è¦è¨ˆç®—ç´…è‰²å€åŸŸçš„ç¸½å’Œï¼š
   
   +-------+-------+
   |   A   |   B   |
   +-------+-------+
   |   C   | [RED] |
   +-------+-------+
   
   RED = (A+B+C+RED) - (A+B) - (A+C) + A
       = prefix[r2][c2] - prefix[r1-1][c2] 
         - prefix[r2][c1-1] + prefix[r1-1][c1-1]
   ```

3. **å·®åˆ†é™£åˆ—çš„åŸç†**
   ```python
   # å°å€é–“ [2, 5] åŠ  3
   diff[2] += 3   # å¾ä½ç½® 2 é–‹å§‹å¢åŠ 
   diff[6] -= 3   # å¾ä½ç½® 6 é–‹å§‹æ¸›å°‘
   
   # é‚„åŸå¾Œï¼š
   # ä½ç½® 0,1: ä¸è®Š
   # ä½ç½® 2,3,4,5: +3
   # ä½ç½® 6 ä¹‹å¾Œ: ä¸è®Š
   ```

4. **çŸ©é™£éæ­·æ¨¡å¼**
   - é€è¡Œéæ­·ï¼š`for i in range(rows): for j in range(cols)`
   - é€åˆ—éæ­·ï¼š`for j in range(cols): for i in range(rows)`
   - å°è§’ç·šéæ­·ï¼š`for i in range(n): matrix[i][i]`
   - èºæ—‹éæ­·ï¼šä½¿ç”¨å››å€‹é‚Šç•ŒæŒ‡æ¨™

## ğŸ“ Quizï¼šèƒ½é‡è­·ç›¾å……èƒ½ç³»çµ±

### é¡Œç›®ï¼šå€åŸŸå……èƒ½å„ªåŒ–

åœŸæ˜Ÿæ¢éšªéšŠçš„èƒ½é‡è­·ç›¾ç”± NÃ—N çš„èƒ½é‡æ ¼çµ„æˆã€‚åˆå§‹æ™‚æ‰€æœ‰æ ¼å­çš„èƒ½é‡éƒ½æ˜¯ 0ã€‚ç¾åœ¨æœ‰ M æ¬¡å……èƒ½æ“ä½œï¼Œæ¯æ¬¡æ“ä½œæœƒå°ä¸€å€‹çŸ©å½¢å€åŸŸå…§çš„æ‰€æœ‰æ ¼å­å¢åŠ èƒ½é‡ã€‚

è«‹è¨ˆç®—ï¼š
1. æ‰€æœ‰å……èƒ½æ“ä½œå®Œæˆå¾Œï¼Œæ¯å€‹æ ¼å­çš„æœ€çµ‚èƒ½é‡
2. èƒ½é‡æœ€é«˜çš„æ ¼å­ä½ç½®åŠå…¶èƒ½é‡å€¼
3. ç¸½èƒ½é‡

**è¼¸å…¥æ ¼å¼ï¼š**
- ç¬¬ä¸€è¡Œï¼šæ•´æ•¸ Nï¼ˆè­·ç›¾å¤§å°ï¼Œ1 â‰¤ N â‰¤ 100ï¼‰
- ç¬¬äºŒè¡Œï¼šæ•´æ•¸ Mï¼ˆå……èƒ½æ¬¡æ•¸ï¼Œ1 â‰¤ M â‰¤ 1000ï¼‰
- æ¥ä¸‹ä¾† M è¡Œï¼Œæ¯è¡Œ 5 å€‹æ•´æ•¸ï¼šr1 c1 r2 c2 energy
  - è¡¨ç¤ºå°å¾ (r1,c1) åˆ° (r2,c2) çš„çŸ©å½¢å€åŸŸå¢åŠ  energy èƒ½é‡

**è¼¸å…¥ç¯„ä¾‹ï¼š**
```
4
3
0 0 1 1 10
1 1 2 2 20
0 0 3 3 5
```

**è¼¸å‡ºç¯„ä¾‹ï¼š**
```
æœ€çµ‚èƒ½é‡åˆ†å¸ƒï¼š
15 15 5 5
15 35 25 5
5 25 25 5
5 5 5 5

æœ€é«˜èƒ½é‡ï¼š35
ä½ç½®ï¼š(1, 1)
ç¸½èƒ½é‡ï¼š240
```

### ğŸ’¡ æç¤º
- å¯ä»¥ç›´æ¥æš´åŠ›æ›´æ–°æ¯å€‹æ ¼å­ï¼ˆç°¡å–®ä½†å¯èƒ½è¼ƒæ…¢ï¼‰
- æˆ–ä½¿ç”¨äºŒç¶­å·®åˆ†é™£åˆ—ï¼ˆé€²éšæŠ€å·§ï¼‰

---

## âœ… Quiz è§£ç­”

### è§£æ³• 1ï¼šç›´æ¥æ›´æ–°ï¼ˆé©åˆåˆå­¸è€…ï¼‰

```python
import sys

# è®€å–è­·ç›¾å¤§å°
n = int(sys.stdin.readline())

# å‰µå»ºèƒ½é‡çŸ©é™£
energy = [[0 for _ in range(n)] for _ in range(n)]

# è®€å–å……èƒ½æ¬¡æ•¸
m = int(sys.stdin.readline())

# è™•ç†æ¯æ¬¡å……èƒ½
for _ in range(m):
    r1, c1, r2, c2, power = map(int, sys.stdin.readline().strip().split())
    
    # å°çŸ©å½¢å€åŸŸå…§çš„æ¯å€‹æ ¼å­å¢åŠ èƒ½é‡
    for i in range(r1, r2 + 1):
        for j in range(c1, c2 + 1):
            energy[i][j] += power

# é¡¯ç¤ºæœ€çµ‚èƒ½é‡åˆ†å¸ƒ
print("æœ€çµ‚èƒ½é‡åˆ†å¸ƒï¼š")
for row in energy:
    print(' '.join(map(str, row)))

# æ‰¾å‡ºæœ€é«˜èƒ½é‡
max_energy = 0
max_pos = (0, 0)
total_energy = 0

for i in range(n):
    for j in range(n):
        total_energy += energy[i][j]
        if energy[i][j] > max_energy:
            max_energy = energy[i][j]
            max_pos = (i, j)

print(f"\næœ€é«˜èƒ½é‡ï¼š{max_energy}")
print(f"ä½ç½®ï¼š{max_pos}")
print(f"ç¸½èƒ½é‡ï¼š{total_energy}")
```

### è§£æ³• 2ï¼šäºŒç¶­å·®åˆ†é™£åˆ—ï¼ˆé€²éšï¼‰

```python
import sys

n = int(sys.stdin.readline())

# äºŒç¶­å·®åˆ†é™£åˆ—
diff = [[0 for _ in range(n+1)] for _ in range(n+1)]

m = int(sys.stdin.readline())

# è¨˜éŒ„å·®åˆ†
for _ in range(m):
    r1, c1, r2, c2, power = map(int, sys.stdin.readline().strip().split())
    
    # äºŒç¶­å·®åˆ†æ¨™è¨˜
    diff[r1][c1] += power
    diff[r1][c2+1] -= power
    diff[r2+1][c1] -= power
    diff[r2+1][c2+1] += power

# é‚„åŸå¯¦éš›èƒ½é‡ï¼ˆäºŒç¶­å‰ç¶´å’Œï¼‰
energy = [[0 for _ in range(n)] for _ in range(n)]

for i in range(n):
    for j in range(n):
        energy[i][j] = diff[i][j]
        if i > 0:
            energy[i][j] += energy[i-1][j]
        if j > 0:
            energy[i][j] += energy[i][j-1]
        if i > 0 and j > 0:
            energy[i][j] -= energy[i-1][j-1]

# è¼¸å‡ºçµæœï¼ˆåŒä¸Šï¼‰
print("æœ€çµ‚èƒ½é‡åˆ†å¸ƒï¼š")
for row in energy:
    print(' '.join(map(str, row)))

max_energy = max(max(row) for row in energy)
total_energy = sum(sum(row) for row in energy)

for i in range(n):
    for j in range(n):
        if energy[i][j] == max_energy:
            max_pos = (i, j)
            break

print(f"\næœ€é«˜èƒ½é‡ï¼š{max_energy}")
print(f"ä½ç½®ï¼š{max_pos}")
print(f"ç¸½èƒ½é‡ï¼š{total_energy}")
```

### è§£ç­”èªªæ˜

**è§£æ³• 1 çš„å„ªç¼ºé»ï¼š**
- âœ… ç°¡å–®ç›´è§€ï¼Œå®¹æ˜“ç†è§£
- âœ… é©åˆ M å’Œå€åŸŸå¤§å°éƒ½ä¸å¤§çš„æƒ…æ³
- âŒ æ™‚é–“è¤‡é›œåº¦ï¼šO(M Ã— å€åŸŸå¤§å°)

**è§£æ³• 2 çš„å„ªç¼ºé»ï¼š**
- âœ… æ™‚é–“è¤‡é›œåº¦ï¼šO(M + NÂ²)ï¼Œæ›´é«˜æ•ˆ
- âœ… é©åˆå¤§é‡æ›´æ–°æ“ä½œ
- âŒ è¼ƒè¤‡é›œï¼Œéœ€è¦ç†è§£å·®åˆ†åŸç†

### æ•ˆèƒ½æ¯”è¼ƒ

| æƒ…æ³ | è§£æ³• 1 | è§£æ³• 2 |
|------|--------|--------|
| N=100, M=10, å°å€åŸŸ | å¿«é€Ÿ | å¿«é€Ÿ |
| N=100, M=1000, å¤§å€åŸŸ | è¼ƒæ…¢ | å¿«é€Ÿ |
| N=1000, M=10000 | è¶…æ™‚ | å¯è¡Œ |

---

## ğŸ¯ è¨“ç·´å®Œæˆï¼

æ­å–œä½ å®ŒæˆåœŸæ˜Ÿç’°æ¨¡æ“¬è¨“ç·´ï¼ä½ ç¾åœ¨å·²ç¶“æŒæ¡ï¼š
- âœ… äºŒç¶­é™£åˆ—çš„æ­£ç¢ºå‰µå»ºèˆ‡æ“ä½œ
- âœ… çŸ©é™£éæ­·çš„å¤šç¨®æ¨¡å¼
- âœ… å‰ç¶´å’Œï¼šO(1) å€åŸŸæŸ¥è©¢
- âœ… å·®åˆ†é™£åˆ—ï¼šO(1) å€é–“æ›´æ–°
- âœ… å®¹æ–¥åŸç†çš„æ‡‰ç”¨

**ä¸‹ä¸€ç«™ï¼šå¤©ç‹æ˜Ÿå‡½æ•¸å·¥å»  - æ¨¡çµ„åŒ–èˆ‡å‡½æ•¸è¨­è¨ˆï¼**

---

## ğŸ”— APCS å°æ‡‰èƒ½åŠ›
- **ç´šåˆ†ç›®æ¨™**ï¼š3 ç´šåˆ†
- **è©•é‡é …ç›®**ï¼šäºŒç¶­é™£åˆ—ã€å‰ç¶´å’Œã€å·®åˆ†é™£åˆ—
- **å°æ‡‰é¡Œå‹**ï¼šb965 (çŸ©é™£è½‰æ›)ã€h027 (çŸ©é™£ç¸½å’Œ)
- **æ ¸å¿ƒæŠ€èƒ½**ï¼šçŸ©é™£æ“ä½œã€å€é–“æŸ¥è©¢èˆ‡æ›´æ–°å„ªåŒ–
